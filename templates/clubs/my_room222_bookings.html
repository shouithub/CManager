{% extends 'clubs/base.html' %}
{% load static %}

{% block title %}我的222房间预约{% endblock %}

{% block extra_css %}
<style>
    .bookings-container {
        max-width: 1100px;
        margin: 0 auto;
        padding: 28px 18px 48px;
    }

    .bookings-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 14px;
        margin-bottom: 20px;
    }

    .bookings-title {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 24px;
        font-weight: 700;
        color: var(--md3-on-surface);
        letter-spacing: 0.3px;
    }

    .action-btns {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .btn {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 10px 16px;
        border-radius: 999px;
        font-weight: 600;
        font-size: 14px;
        text-decoration: none;
        border: 1px solid transparent;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        box-shadow: var(--md3-elevation-1);
    }

    .btn:hover {
        transform: translateY(-1px);
        box-shadow: var(--md3-elevation-2);
    }

    .btn-primary {
        background: var(--md3-primary);
        color: var(--md3-on-primary);
    }

    .btn-secondary {
        background: var(--md3-surface-container-high);
        color: var(--md3-on-surface);
        border-color: var(--md3-outline-variant);
    }

    .bookings-list {
        display: grid;
        gap: 14px;
    }

    .booking-card {
        position: relative;
        background: var(--md3-surface-container);
        border: 1px solid var(--md3-outline-variant);
        border-radius: 18px;
        padding: 16px 18px 14px 20px;
        box-shadow: var(--md3-elevation-1);
        display: grid;
        grid-template-columns: auto 1fr auto;
        gap: 14px;
        align-items: center;
        overflow: hidden;
    }

    .booking-card:hover {
        box-shadow: var(--md3-elevation-2);
    }

    .booking-meta {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding-left: 4px;
    }

    .booking-date-row {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 700;
        color: var(--md3-on-surface);
        font-size: 15px;
        letter-spacing: 0.2px;
    }

    .chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 999px;
        background: var(--md3-surface-container-high);
        color: var(--md3-on-surface);
        font-size: 13px;
        font-weight: 600;
        border: 1px solid var(--md3-outline-variant);
    }

    .chip .material-icons {
        font-size: 16px;
        color: var(--md3-primary);
    }

    .booking-detail-row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        color: var(--md3-on-surface-variant);
        font-size: 13px;
    }

    .detail-pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 10px;
        border-radius: 12px;
        background: var(--md3-surface-container-highest);
        border: 1px solid var(--md3-outline-variant);
        font-weight: 600;
    }

    .detail-pill .material-icons {
        font-size: 16px;
        color: var(--md3-primary);
    }

    .booking-purpose {
        color: var(--md3-on-surface-variant);
        font-size: 13px;
        line-height: 1.5;
    }

    .booking-status-actions {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 10px;
    }

    .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        border-radius: 999px;
        font-weight: 700;
        font-size: 13px;
        letter-spacing: 0.25px;
    }

    .status-badge.active {
        background: var(--md3-tertiary-container);
        color: var(--md3-on-tertiary-container);
    }

    .status-badge.cancelled {
        background: var(--md3-error-container);
        color: var(--md3-on-error-container);
    }

    .booking-actions {
        display: flex;
        gap: 8px;
    }

    .action-btn {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        border-radius: 12px;
        font-size: 13px;
        font-weight: 600;
        text-decoration: none;
        border: 1px solid transparent;
        transition: background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    }

    .edit-btn {
        background: var(--md3-primary);
        color: var(--md3-on-primary);
    }

    .edit-btn:hover {
        background: var(--md3-primary-container);
        color: var(--md3-on-primary-container);
    }

    .delete-btn {
        background: var(--md3-error-container);
        color: var(--md3-on-error-container);
    }

    .delete-btn:hover {
        background: var(--md3-error);
        color: var(--md3-on-error);
    }

    .empty-state {
        margin-top: 24px;
        text-align: center;
        padding: 48px 20px;
        background: var(--md3-surface-container);
        border-radius: 18px;
        border: 1px dashed var(--md3-outline-variant);
        box-shadow: var(--md3-elevation-1);
    }

    .empty-icon {
        width: 96px;
        height: 96px;
        margin: 0 auto 16px;
        background: var(--md3-surface-container-highest);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--md3-elevation-1);
    }

    .empty-icon .material-icons {
        font-size: 44px;
        color: var(--md3-on-surface-variant);
    }

    .empty-title {
        font-size: 20px;
        font-weight: 700;
        color: var(--md3-on-surface);
        margin-bottom: 6px;
    }

    .empty-text {
        font-size: 14px;
        color: var(--md3-on-surface-variant);
        margin-bottom: 18px;
    }
    
    @media (max-width: 1024px) {
        .bookings-container {
            padding: 24px 16px;
        }

        .bookings-title {
            font-size: 28px;
        }

        .booking-card {
            padding: 20px;
        }
    }

    @media (max-width: 820px) {
        .bookings-container { padding: 22px 12px 36px; }
        .bookings-title { font-size: 22px; }
        .booking-card { grid-template-columns: auto 1fr; padding: 14px; }
        .booking-status-actions { grid-column: 1 / -1; align-items: flex-start; }
    }

    @media (max-width: 540px) {
        .bookings-container { padding: 18px 8px 28px; }
        .bookings-title { font-size: 20px; }
        .btn { width: 100%; justify-content: center; }
        .action-btns { width: 100%; }
        .booking-card { grid-template-columns: 1fr; }
        .booking-detail-row { gap: 8px; }
        .detail-pill { width: 100%; justify-content: flex-start; }
        .booking-status-actions { align-items: flex-start; }
    }
</style>
{% endblock %}

{% block content %}
<div class="bookings-container">
    <div class="bookings-header">
        <h1 class="bookings-title">
            <span class="material-icons" style="font-size: 26px;">event_note</span>
            <span>我的预约</span>
        </h1>
        <div class="action-btns">
            <a href="{% url 'clubs:room222_calendar' %}" class="btn btn-secondary">
                <span class="material-icons">event</span>
                <span>查看日历</span>
            </a>
            <a href="{% url 'clubs:submit_room222_booking' %}" class="btn btn-primary">
                <span class="material-icons">add_circle</span>
                <span>新建预约</span>
            </a>
        </div>
    </div>
    
    {% if bookings %}
    <div class="bookings-list">
        {% for booking in bookings %}
        <div class="booking-card">
            <div class="booking-meta">
                <div class="booking-date-row">
                    <span class="material-icons" style="font-size:18px; color: var(--md3-primary);">event</span>
                    <span>{{ booking.booking_date|date:"Y年m月d日" }}</span>
                    <span class="chip">
                        <span class="material-icons">schedule</span>
                        {{ booking.start_time|time:"H:i" }} - {{ booking.end_time|time:"H:i" }}
                    </span>
                </div>
                <div class="booking-detail-row">
                    <span class="detail-pill">
                        <span class="material-icons">groups</span>
                        {{ booking.participant_count }}人
                    </span>
                    {% if booking.club %}
                    <span class="detail-pill">
                        <span class="material-icons">group_work</span>
                        {{ booking.club.name }}
                    </span>
                    {% endif %}
                    <span class="detail-pill">
                        <span class="material-icons">phone</span>
                        {{ booking.contact_phone }}
                    </span>
                </div>
                <div class="booking-purpose">{{ booking.purpose }}</div>
                {% if booking.special_requirements %}
                <div class="booking-purpose">特殊需求：{{ booking.special_requirements }}</div>
                {% endif %}
            </div>
            <div class="booking-status-actions">
                {% if booking.status == 'active' %}
                    <span class="status-badge active">
                        <span class="material-icons">check_circle</span> 有效
                    </span>
                {% elif booking.status == 'cancelled' %}
                    <span class="status-badge cancelled">
                        <span class="material-icons">cancel</span> 已取消
                    </span>
                {% endif %}
                {% if booking.status == 'active' %}
                <div class="booking-actions">
                    <a href="{% url 'clubs:edit_room222_booking' booking.id %}" class="action-btn edit-btn">
                        <span class="material-icons">edit</span>
                        编辑
                    </a>
                    <a href="{% url 'clubs:delete_room222_booking' booking.id %}" class="action-btn delete-btn">
                        <span class="material-icons">delete</span>
                        取消
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">
            <span class="material-icons">event_busy</span>
        </div>
        <h2 class="empty-title">暂无预约记录</h2>
        <p class="empty-text">您还没有任何222房间的预约记录</p>
        <a href="{% url 'clubs:submit_room222_booking' %}" class="btn btn-primary">
            <span class="material-icons">add_circle</span>
            <span>立即预约</span>
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
