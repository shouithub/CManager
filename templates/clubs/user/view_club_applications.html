{% extends 'clubs/base.html' %}
{% load static %}

{% block title %}社团申请记录{% endblock %}

{% block extra_css %}
<style>
    .page-header {
        display: flex;
        align-items: center;
        gap: var(--md3-spacing-md);
        margin-bottom: var(--md3-spacing-2xl);
        padding: var(--md3-spacing-xl);
        background: var(--md3-surface-container-low);
        border-radius: var(--md3-radius-lg);
    }
    
    .page-header .material-icons {
        font-size: 2.5rem;
        color: var(--md3-primary);
    }
    
    .page-header h1 {
        margin: 0;
        font-size: 2rem;
        font-weight: 600;
        color: var(--md3-on-surface);
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <span class="material-icons">description</span>
    <h1>社团申请记录</h1>
</div>

<div class="container my-4">
    
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
    
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>社团名称</th>
                <th>提交时间</th>
                <th>提交次数</th>
                <th>状态</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for application in applications %}
            <tr>
                <td>{{ application.club_name }}</td>
                <td>{{ application.created_at|date:"Y-m-d H:i" }}</td>
                <td>
                    第 {{ application.resubmission_attempt }} 次
                    {% if application.resubmission_attempt > 1 %}
                        <span style="color: #dc3545; font-weight: 500;">(重新提交)</span>
                    {% endif %}
                </td>
                <td>
                    {% if application.status == 'pending' %}
                        <span class="badge badge-warning px-2 py-1" style="border: 1px solid #ffc107;">待审核</span>
                    {% elif application.status == 'approved' %}
                        <span class="badge badge-success px-2 py-1" style="border: 1px solid #28a745;">已批准</span>
                    {% elif application.status == 'rejected' %}
                          <span class="badge badge-danger px-2 py-1" style="border: 1px solid #dc3545;">已拒绝</span>
                    {% endif %}
                </td>
                <td>
                    {% if application.status == 'pending' %}
                        <a href="#" class="btn btn-sm btn-secondary" disabled>待审核</a>
                    {% elif application.status == 'approved' %}
                        <a href="#" class="btn btn-sm btn-success" disabled>已批准</a>
                    {% elif application.status == 'rejected' %}
                    <a href="{% url 'clubs:edit_rejected_review' club_id=0 %}?type=club_application&request_id={{ application.id }}" class="btn btn-sm btn-primary">重新提交</a>
                    {% endif %}
                </td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="4" class="text-center">暂无社团申请记录</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}