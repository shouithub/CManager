{% extends 'clubs/base.html' %}

{% block title %}ç”¨æˆ·ä»ªè¡¨æ¿{% endblock %}

{% block content %}
<div style="margin-bottom: 20px;">
    <h2>ğŸ‘¤ ç”¨æˆ·ä»ªè¡¨æ¿</h2>
    <p style="color: #666;">æ¬¢è¿ {{ user.profile.get_full_name }}ï¼Œä»¥ä¸‹æ˜¯æ‚¨çš„ç¤¾å›¢ç®¡ç†ä¿¡æ¯</p>
</div>

{% if unread_reviews_count > 0 %}
<div style="background-color: #fff3cd; border: 1px solid #ffeaa7; color: #856404; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
    <h3 style="margin-top: 0;">ğŸ“¢ æœªè¯»é€šçŸ¥</h3>
    <p>æ‚¨æœ‰ {{ unread_reviews_count }} æ¡æœªè¯»å®¡æ ¸ç»“æœï¼Œè¯·åŠæ—¶æŸ¥çœ‹</p>
    <a href="#unread-reviews" class="btn btn-primary" style="background-color: #ffc107; border-color: #ffc107; color: #212529;">
        æŸ¥çœ‹æœªè¯»ç»“æœ
    </a>
</div>
{% endif %}

<div style="margin-bottom: 30px;">
    <h3>ğŸ« æˆ‘çš„ç¤¾å›¢</h3>
    <p>æ‚¨å…±ç®¡ç† {{ club_count }} ä¸ªç¤¾å›¢</p>
    
    {% if clubs_with_submission_status %}
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
        {% for club_data in clubs_with_submission_status %}
        <div style="background-color: #f8f9fa; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h4 style="margin-top: 0; margin-bottom: 15px;">{{ club_data.club.name }}</h4>
            
            <div style="margin-bottom: 10px;">
                <strong>å¹´å®¡çŠ¶æ€:</strong>
                {% if club_data.has_submitted_review %}
                <span style="color: #28a745; font-weight: bold;">âœ… å·²æäº¤</span>
                {% else %}
                <span style="color: #dc3545; font-weight: bold;">âŒ æœªæäº¤</span>
                {% endif %}
            </div>
            
            <div style="margin-bottom: 10px;">
                <strong>è´Ÿè´£å¹²äº‹:</strong>
                {% if club_data.assigned_staff %}
                {{ club_data.assigned_staff }}
                {% else %}
                æš‚æœªåˆ†é…
                {% endif %}
            </div>
            
            <div style="margin-bottom: 15px;">
                <strong>æœªè¯»å®¡æ ¸:</strong>
                {% if club_data.unread_submissions_count > 0 %}
                <span style="color: #dc3545; font-weight: bold;">{{ club_data.unread_submissions_count }} æ¡</span>
                {% else %}
                <span style="color: #28a745; font-weight: bold;">0 æ¡</span>
                {% endif %}
            </div>
            
            <div style="display: flex; gap: 10px;">
                <a href="{% url 'clubs:club_detail' club_data.club.id %}" class="btn btn-primary" style="flex: 1;">æŸ¥çœ‹è¯¦æƒ…</a>
                {% if not club_data.has_submitted_review %}
                <a href="{% url 'clubs:submit_review' club_data.club.id %}" class="btn btn-success" style="flex: 1;">æäº¤å¹´å®¡</a>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div style="background-color: #f8f9fa; border-radius: 8px; padding: 30px; text-align: center; margin-top: 20px;">
        <p style="color: #6c757d;">æ‚¨ç›®å‰æ²¡æœ‰ç®¡ç†ä»»ä½•ç¤¾å›¢</p>
    </div>
    {% endif %}
</div>

{% if unread_reviews_count > 0 %}
<div id="unread-reviews" style="margin-bottom: 30px;">
    <h3>ğŸ“‹ æœªè¯»å®¡æ ¸ç»“æœ</h3>
    
    <div style="margin-top: 20px;">
        {% for review in unread_reviews %}
        <div style="background-color: #f8f9fa; border-radius: 8px; padding: 20px; margin-bottom: 15px; border-left: 5px solid #ffc107;">
            <h4 style="margin-top: 0; margin-bottom: 10px;">{{ review.club.name }} - å®¡æ ¸ç»“æœ</h4>
            <p><strong>ç±»å‹:</strong> {{ review.get_review_type_display }}</p>
            <p><strong>æäº¤æ—¶é—´:</strong> {{ review.submitted_at|date:"Y-m-d H:i" }}</p>
            <p><strong>å®¡æ ¸æ—¶é—´:</strong> {{ review.reviewed_at|date:"Y-m-d H:i" }}</p>
            <p><strong>çŠ¶æ€:</strong> 
                {% if review.status == 'approved' %}
                <span style="color: #28a745; font-weight: bold;">å·²é€šè¿‡</span>
                {% elif review.status == 'rejected' %}
                <span style="color: #dc3545; font-weight: bold;">å·²æ‹’ç»</span>
                {% endif %}
            </p>
            <a href="{% url 'clubs:view_submissions' review.club.id %}" class="btn btn-primary" style="margin-top: 10px;">
                æŸ¥çœ‹å®Œæ•´è¯¦æƒ…
            </a>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
{% endblock %}